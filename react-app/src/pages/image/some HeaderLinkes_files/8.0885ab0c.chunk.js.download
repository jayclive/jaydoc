(this["webpackJsonpebanqo-messenger"]=this["webpackJsonpebanqo-messenger"]||[]).push([[8],{169:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return r}));var a={},i=function(){var e=0;return function(){return e+=1}}();function c(e,t){var n=i();return a[e]||(a[e]={}),a[e][n]=t,{unsubscribe:function(){delete a[e][n],0===Object.keys(a[e]).length&&delete a[e]}}}function r(e,t){a[e]&&Object.keys(a[e]).forEach((function(n){return a[e][n](t)}))}},170:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(669),i=n(169),c={isConnected:!1,socket:null,interval:null,connect:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"new",n=this;this.socket&&(window.EBQ_WEBCHAT_SOCKET&&window.EBQ_WEBCHAT_SOCKET.destroy(),this.socket.destroy(),this.socket.close(),delete this.socket,window.EBQ_WEBCHAT_SOCKET=null,this.socket=null);return this.socket=a.a.connect("".concat("https://webchat-be.ebanqo.io"),{transports:["websocket"],rejectUnauthorized:!1}),this.socket.on("connect",(function(){e.isConnected=!0,window.EBQ_WEBCHAT_SOCKET=e.socket,console.log("Socket Connected!",e.socket),"new"===t?Object(i.a)("newSocketConnected",e.socket):Object(i.a)("exisitingSocketConnected",e.socket)})),this.socket.on("disconnect",(function(t){e.isConnected=!1,Object(i.a)("socketDisconnected",e.socket),console.log("Socket Disconnected",t),"transport error"===t&&(window.EBQ_WEBCHAT_SOCKET&&window.EBQ_WEBCHAT_SOCKET.destroy(),e.socket.destroy(),e.socket.close(),delete e.socket,window.EBQ_WEBCHAT_SOCKET=null,e.socket=null),"io client disconnect"!==t&&(e.interval=window.setInterval((function(){if(e.isConnected)return clearInterval(e.interval),void(n.interval=null);n.connect("existing")}),5e3))})),this.socket.on("connect_error",(function(e){console.log("SOCKET_CONNECT_ERROR",e)})),this.socket}}},174:function(e,t,n){"use strict";t.a=function(){try{var e=window.localStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(n){return n instanceof DOMException&&(22===n.code||1014===n.code||"QuotaExceededError"===n.name||"NS_ERROR_DOM_QUOTA_REACHED"===n.name)&&e&&0!==e.length}}},681:function(e,t,n){"use strict";n.r(t);var a=n(3),i=n(7),c=n(8),r=n(63),o=n(4),s=n(0),u=n.n(s),d=n(2),l=n(158),f=n.n(l),p=n(97),b=n(673),h=n(674),v=n(675),m=n(82),O=function(){Object.prototype.toString;var e=function(e){return e},t=function(e){var t=null!=e&&"object"===typeof e&&this.prop in e;return this.parser(t?e[this.prop]:e)};return function(n,a){return n instanceof Array&&n.length?("[object Object]"!==Object.prototype.toString.call(a)&&(a={}),"function"!==typeof a.parser&&(a.parser=e),a.desc=a.desc?-1:1,n.sort((function(e,n){return e=t.call(a,e),n=t.call(a,n),a.desc*(e<n?-1:+(e>n))}))):[]}}(),g=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},w=n(169),j=n(170),E=n(339),_=function(e){e&&(m.a.defaults.headers.common.parent="".concat(e),m.b.defaults.headers.common.parent="".concat(e))},S=n.p+"static/media/doc.ef8f3762.svg",y=n.p+"static/media/audio.03c1c260.svg",C=n.p+"static/media/photo.80a54406.svg",M=n(174),B=n(6),T=u.a.lazy((function(){return Promise.all([n.e(0),n.e(4),n.e(1),n.e(9)]).then(n.bind(null,679))})),k=u.a.lazy((function(){return Promise.all([n.e(0),n.e(1),n.e(7)]).then(n.bind(null,680))}));t.default=function(e){var t=e.versionType,n=Object(d.o)().clientCode,u=Object(d.k)(),l=Object(s.useState)(!0),A=Object(o.a)(l,2),x=A[0],I=A[1],N=Object(s.useState)(""),Q=Object(o.a)(N,2),U=Q[0],W=Q[1],H=Object(s.useState)(""),D=Object(o.a)(H,2),P=D[0],F=D[1],R=Object(s.useState)(!1),G=Object(o.a)(R,2),L=G[0],K=G[1],z=Object(s.useState)([]),V=Object(o.a)(z,2),q=V[0],J=V[1],Y=Object(s.useState)([]),$=Object(o.a)(Y,2),X=$[0],Z=$[1],ee=Object(s.useState)([]),te=Object(o.a)(ee,2),ne=te[0],ae=te[1],ie=Object(s.useState)([]),ce=Object(o.a)(ie,2),re=ce[0],oe=ce[1],se=Object(s.useState)(null),ue=Object(o.a)(se,2),de=ue[0],le=ue[1],fe=Object(s.useState)(null),pe=Object(o.a)(fe,2),be=pe[0],he=pe[1],ve=Object(s.useState)(!0),me=Object(o.a)(ve,2),Oe=me[0],ge=me[1],we=Object(s.useState)(null),je=Object(o.a)(we,2),Ee=je[0],_e=je[1],Se=Object(s.useState)(!1),ye=Object(o.a)(Se,2),Ce=ye[0],Me=ye[1],Be=Object(s.useState)({}),Te=Object(o.a)(Be,2),ke=Te[0],Ae=Te[1],xe=Object(s.useState)([]),Ie=Object(o.a)(xe,2),Ne=Ie[0],Qe=Ie[1],Ue=Object(s.useState)(!1),We=Object(o.a)(Ue,2),He=We[0],De=We[1],Pe=Object(s.useState)(!1),Fe=Object(o.a)(Pe,2),Re=Fe[0],Ge=Fe[1],Le=Object(s.useState)(""),Ke=Object(o.a)(Le,2),ze=Ke[0],Ve=Ke[1],qe=Object(s.useState)(!1),Je=Object(o.a)(qe,2),Ye=Je[0],$e=Je[1],Xe=Object(s.useState)(!1),Ze=Object(o.a)(Xe,2),et=Ze[0],tt=Ze[1],nt=Object(s.useState)(!1),at=Object(o.a)(nt,2),it=(at[0],at[1],Object(s.useState)(!1)),ct=Object(o.a)(it,2),rt=ct[0],ot=ct[1],st=Object(s.useState)(!1),ut=Object(o.a)(st,2),dt=ut[0],lt=(ut[1],Object(s.useState)({type:"",status:!1})),ft=Object(o.a)(lt,2),pt=ft[0],bt=ft[1],ht=Object(s.useState)({}),vt=Object(o.a)(ht,2),mt=vt[0],Ot=vt[1],gt=Object(s.useState)({visible:!1,modalData:{}}),wt=Object(o.a)(gt,2),jt=wt[0],Et=wt[1],_t=Object(s.useState)(!1),St=Object(o.a)(_t,2),yt=St[0],Ct=St[1],Mt=Object(s.useState)(null),Bt=Object(o.a)(Mt,2),Tt=Bt[0],kt=Bt[1],At=Object(s.useState)(!1),xt=Object(o.a)(At,2),It=xt[0],Nt=xt[1],Qt=Object(s.useState)(null),Ut=Object(o.a)(Qt,2);Ut[0],Ut[1];Object(w.b)("exisitingSocketConnected",(function(e){if(window.EBQ_RECONNECT_SOCKET){if(window.EBQ_RECONNECT_SOCKET.id!==e.id&&!0!==window.EBQ_RECONNECT_SOCKET.connected){if("object"===typeof window.EBQ_WEBCHAT_USER_INFO){var t=window.EBQ_WEBCHAT_USER_INFO,n=t.sender_id,a=t.recipient_id;e.emit("send",{type:"connection",recipient_id:a,sender_id:n})}he(e),Me(!0)}}else if(he(e),Me(!0),"object"===typeof window.EBQ_WEBCHAT_USER_INFO){var i=window.EBQ_WEBCHAT_USER_INFO,c=i.sender_id,r=i.recipient_id;e.emit("send",{type:"connection",recipient_id:r,sender_id:c})}window.EBQ_RECONNECT_SOCKET=e})),Object(w.b)("socketDisconnected",(function(e){Me((function(e){return!1}))})),Object(w.b)("newSocketConnected",(function(e){Me((function(e){return!0})),he((function(t){return e}))})),Object(s.useEffect)((function(){W(n);var e=window.location!=window.parent.location?document.referrer:document.location.href;window.parent.postMessage("webchat_loaded",e)}),[]),Object(s.useEffect)((function(){var e,t=f.a.parse(u.search);if(t.version&&delete t.version,de&&be){var n,a;if(Object(M.a)())e=JSON.parse((null===(n=localStorage)||void 0===n?void 0:n.getItem("".concat(de.agent_code,"_webchat_user_info")))||"null");if(e&&e.sender_id)return _e((function(t){return Object(r.a)(Object(r.a)({},t),e)})),window.EBQ_WEBCHAT_USER_INFO=e,e.rememberMe&&K((function(e){return!1})),be.emit("send",{type:"connection",recipient_id:e.recipient_id,sender_id:e.sender_id}),null!==t&&void 0!==t&&null!==(a=t.source)&&void 0!==a&&a.includes("appchat")?void Ht(t):void Dt(e.sender_id,e.recipient_id,null===t||void 0===t?void 0:t.source);de&&de.show_reg_form?g(t)?Gt():Ht(t):g(t)?Ht(t):Ht()}}),[de]),Object(s.useEffect)((function(){U&&(he(j.a.connect()),U&&Wt(U))}),[U]),Object(s.useEffect)((function(){be&&be.on("receive",(function(e){switch(console.log(e),e.type){case"userMessage":$e((function(e){return!1})),Me((function(e){return!0}));var t=window.EBQ_WEBCHAT_USER_INFO,n=t.sender_id,a=t.recipient_id;if(be.emit("send",{type:"ack",sender_id:n,recipient_id:a,id:e.data.id}),e&&"incoming"===e.data.type){var i=window.EBQ_WEBCHAT_DELIVERED_MESSAGES.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{quick_replies:[],buttons:[]})})),o=window.EBQ_WEBCHAT_SENT_MESSAGES.filter((function(t){return t.timestamp!==e.data.timestamp}));Z((function(e){return o})),oe((function(t){return[].concat(Object(c.a)(i),[Object(r.a)(Object(r.a)({},e.data),{},{sender:"bot"})])}))}if(e&&"outgoing"===e.data.type){var s=window.EBQ_WEBCHAT_SENT_MESSAGES.filter((function(t){return t.timestamp!==e.data.timestamp})),u=window.EBQ_WEBCHAT_PENDING_MESSAGES.filter((function(t){return t.timestamp!==e.data.timestamp}));Z((function(e){return s})),oe((function(t){var n=Object(r.a)(Object(r.a)({},e.data),{},{date:(new Date).toISOString(),sender:"user",quick_replies:[]});return n.attachments&&n.attachments.length?[].concat(Object(c.a)(t),[Object(r.a)(Object(r.a)({},n),{},{msg_type:"attachment",allDelivered:!0})]):[].concat(Object(c.a)(t),[n])})),ae((function(e){return u}))}break;case"typing":$e((function(e){return!0})),ge((function(e){return!1}))}}))}),[be]),Object(s.useEffect)((function(){window.EBQ_WEBCHAT_SENT_MESSAGES=X}),[X]),Object(s.useEffect)((function(){window.EBQ_WEBCHAT_PENDING_MESSAGES=ne}),[ne]),Object(s.useEffect)((function(){window.EBQ_WEBCHAT_DELIVERED_MESSAGES=re,ge((function(e){return!1}))}),[re]),Object(s.useEffect)((function(){var e=window.location!=window.parent.location?document.referrer:document.location.href;window.parent.postMessage("iframe_message",e);var t=function(e){e.origin&&_(e.origin)},a=setTimeout((function(){W(n)}),1e3);return window.addEventListener("message",t,!1),function(){window.removeEventListener("message",t),clearTimeout(a)}}),[]);var Wt=function(){var e=Object(i.a)(Object(a.a)().mark((function e(n){var i,c,r;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.b)(n);case 2:if("404"!==(i=e.sent)){e.next=7;break}return bt({type:"Not Found",status:!0}),I(!1),e.abrupt("return");case 7:if(c=window.location!=window.parent.location?document.referrer:document.location.href,window.parent.postMessage({type:"webchat_client_config",configs:null===i||void 0===i?void 0:i.data},c),"v2"!==t){e.next=15;break}if(null!==i.data.options){e.next=14;break}return bt({type:"Does not exist on V2",status:!0}),I(!1),e.abrupt("return");case 14:Ot(null===(r=i.data.options)||void 0===r?void 0:r.platforms);case 15:window.EBQ_WEBCHAT_CLIENT_INFO=i.data,le((function(e){return i.data})),I(!1);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ht=function(e){var t={fullname:null,email:null,recipient_id:de.agent_code,status:"new",timestamp:(new Date).getTime(),form:Object(r.a)({},e)};m.c.webchat.initialUserRegistration(t).then((function(n){if(ge(!1),"success"===n.data.status){var a=Object(r.a)(Object(r.a)(Object(r.a)({},t),n.data.data),{},{rememberMe:"appchat"===(null===e||void 0===e?void 0:e.source)});vn(a)}})).catch((function(e){return ge(!1)}))},Dt=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,n){var i,o,s,u=arguments;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>2&&void 0!==u[2]?u[2]:"webchat",ge(!0),e.next=4,Object(p.e)(t,n,i);case 4:o=e.sent,ge((function(e){return!1})),s=(s=o?o.data&&Array.isArray(o.data.data)&&o.data.data.map((function(e){var t=Object(r.a)(Object(r.a)({},e),{},{icon:de.icon,history:!0,allDelivered:!0,attachments:"string"===typeof e.attachments?JSON.parse(e.attachments):e.attachments});return e.attachments&&e.attachments.length?Object(r.a)(Object(r.a)({},t),{},{msg_type:"attachment"}):t})):[])&&s.length?s:[],oe((function(e){return O([].concat(Object(c.a)(e),Object(c.a)(s)),{prop:"date",desc:!1})}));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Pt=function(){Object(M.a)()&&localStorage.removeItem("".concat(de.agent_code,"_webchat_user_info")),K((function(e){return!0})),J((function(e){return[]})),Z((function(e){return[]})),ae((function(e){return[]})),oe((function(e){return[]})),window.EBQ_WEBCHAT_SOCKET&&window.EBQ_WEBCHAT_SOCKET.close()},Ft=function(){Ct(!0),zt(Ee.sender_id,Ee.recipient_id).then((function(e){return Ct(!1)}))},Rt=function(e){kt(e),Nt(!0)},Gt=function(){K((function(e){return!e}))},Lt=function(e){Qe((function(t){return[].concat(Object(c.a)(t),[e])}))},Kt=function(){Ge(!1),De(!1),Qe([]),an({})},zt=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,n){var i;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ge((function(e){return!0})),e.next=3,Object(p.d)(t,n);case 3:i=e.sent,J((function(e){return i&&Array.isArray(i)?Object(c.a)(i):e})),ge((function(e){return!1}));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Vt=function(e,t){var n=window.EBQ_WEBCHAT_PENDING_MESSAGES&&window.EBQ_WEBCHAT_PENDING_MESSAGES.map((function(n){var a=n;if(a.attachments){var i=a.attachments.map((function(n){return e===n.name?Object(r.a)(Object(r.a)({},n),{},{progress:t}):n}));a.attachments=i}return a}));ae((function(e){return n}))},qt=function(e,t){var n=window.EBQ_WEBCHAT_PENDING_MESSAGES&&window.EBQ_WEBCHAT_PENDING_MESSAGES.map((function(n){var a=n;if(a.attachments){var i=a.attachments.map((function(n){return e===n.name?Object(r.a)(Object(r.a)({},n),{},{error:t}):n}));a.attachments=i}return a}));ae((function(e){return n}))},Jt=function(e){var t=window.EBQ_WEBCHAT_PENDING_MESSAGES&&window.EBQ_WEBCHAT_PENDING_MESSAGES.filter((function(t){return e.timestamp===t.timestamp}))[0];(1===t.attachments.length&&Zt(t),t.attachments.length>1)&&(t.attachments.filter((function(e){return 100===e.progress})).length===t.attachments.length&&Zt(t))},Yt=function(){Nt(!1),kt(null)},$t=function(e,t){var n=e.name.split(".")[e.name.split(".").length-1];return t.check.test("/".concat(n))};function Xt(e){e.forEach((function(e,t){var n=new FileReader;n.onload=function(e){return function(){var c=Object(i.a)(Object(a.a)().mark((function i(c){var o,s;return Object(a.a)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(o={url:n.result,type:e.type.split("/")[0],name:e.name,caption:0===t&&ze?ze:null,img_id:"".concat(e.name).concat((new Date).getTime())},!e.type.includes("video")){a.next=9;break}return a.next=4,Object(E.a)(e,{interval:1,start:2,end:2});case 4:return a.sent,s=Object(r.a)({},o),0===t&&an(s),Lt(s),a.abrupt("return");case 9:0===t&&an(o),Lt(o);case 11:case"end":return a.stop()}}),i)})));return function(e){return c.apply(this,arguments)}}()}(e),Ve(""),n.readAsDataURL(e)}))}var Zt=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.attachments.map((function(e){var t=e;return delete t.progress,delete t.img_id,t.thumbnail&&delete t.thumbnail,t})),e.next=3,m.c.webchat.sendMessage(Object(r.a)(Object(r.a)({},t),{},{attachments:n})).then((function(e){"success"===e.data.status&&(window.EBQ_WEBCHAT_DELIVERED_MESSAGES.filter((function(t){return t.timestamp===e.data.data.timestamp})).length||Z((function(t){return[].concat(Object(c.a)(window.EBQ_WEBCHAT_SENT_MESSAGES),[Object(r.a)(Object(r.a)({},e.data.data),{},{sender:"user",msg_type:"attachment",allSent:!0})])})),ae((function(e){return e.filter((function(e){return e.timestamp!==t.timestamp}))})))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),en=Object(s.useState)({}),tn=Object(o.a)(en,2),nn=tn[0],an=tn[1],cn=[{name:"image",desc:"Photo/Video",listType:"picture-card",accept:"image/png, image/jpeg, image/jpg, video/*",icon:b.a,check:/(\.|\/)(png|jpeg|jpg|3gp|mp4|webm)$/i,svg:C},{name:"audio",desc:"Audio",accept:".mp3, .wav, .ogg",icon:h.a,check:/(\.|\/)(mpeg|wav|ogg|mp3)$/i,svg:y},{name:"application",desc:"Document",accept:"application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint, text/plain, application/pdf, .csv, .xls, .xlsx, .doc, .docx",check:/(\.|\/)(doc|docx|xls|xlsx|ppt|pptx|txt|pdf|csv*)$/i,icon:v.a,svg:S}],rn=function(){Ge((function(e){return!e}))},on=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n,i,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(ze||t)&&(n={text:t||ze,sender_id:null===Ee||void 0===Ee?void 0:Ee.sender_id,recipient_id:null===de||void 0===de?void 0:de.agent_code,timestamp:(new Date).getTime()},m.c.webchat.sendMessage(n).then((function(e){"success"===e.data.status&&(window.EBQ_WEBCHAT_DELIVERED_MESSAGES.filter((function(t){return t.timestamp===e.data.data.timestamp})).length||Z((function(t){return[].concat(Object(c.a)(window.EBQ_WEBCHAT_SENT_MESSAGES),[Object(r.a)(Object(r.a)({},e.data.data),{},{sender:"user"})])})),ae((function(e){return e.filter((function(e){return e.timestamp!==n.timestamp}))})))})),i=window.EBQ_WEBCHAT_DELIVERED_MESSAGES.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{buttons:[],quick_replies:[]})})),oe((function(e){return i})),Ve(""),o=ne.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{buttons:[],quick_replies:[]})})),ae((function(e){return[].concat(Object(c.a)(o),[Object(r.a)(Object(r.a)({},n),{},{date:(new Date).toISOString(),sender:"user"})])})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sn=function(e){Ve(e.target.value)},un=function(e){var t=e.colons;Ve((function(e){return ze+t})),ot(!1)},dn=function(){ot((function(e){return!e}))},ln=function(){ot(!1)},fn=function(){De((function(e){return!0}))},pn=function(e){if(e.name===nn.name&&e.url===nn.url)if(Ne.length<2)Qe([]);else{var t=Ne.findIndex((function(t){return t.url===e.url&&t.name===e.name}));an(Ne[t-1]||Ne[t+1])}Qe((function(t){return t.filter((function(t){return t.name!==e.name||t.url!==e.url}))}))},bn=function(){var e=Object(i.a)(Object(a.a)().mark((function e(){var t,n,o;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Ne.map((function(e,t){var n=Object(r.a)(Object(r.a)({},e),{},{type:e.type,caption:e.caption||null});return["image","audio","video"].includes(e.type)||(n.type="file"),n})),n={attachments:t,sender_id:Ee.sender_id,recipient_id:de.agent_code,msg_type:"attachment",sender:"user",text:null,timestamp:(new Date).getTime()},ae((function(e){return[].concat(Object(c.a)(e),[n])})),o=[],t.forEach((function(e){o.push(m.c.webchat.uploadFile({filename:e.name,data_url:e.url,img_id:e.img_id},Vt).catch((function(t){var n,a,i,c;422===(null===t||void 0===t||null===(n=t.response)||void 0===n?void 0:n.status)&&qt(null===e||void 0===e?void 0:e.name,null===t||void 0===t||null===(a=t.response)||void 0===a||null===(i=a.data)||void 0===i||null===(c=i.data)||void 0===c?void 0:c.message)})))})),Promise.all(o).then((function(e){e.forEach(function(){var t=Object(i.a)(Object(a.a)().mark((function t(i){var o;return Object(a.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:o=window.EBQ_WEBCHAT_PENDING_MESSAGES&&window.EBQ_WEBCHAT_PENDING_MESSAGES.map((function(t){var n=t;if(n.attachments){var a=n.attachments.map((function(t){var n,a=e.find((function(e){var n;return(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.data.img_id)===(null===t||void 0===t?void 0:t.img_id)}));return a?Object(r.a)(Object(r.a)({},t),{},{url:null===a||void 0===a||null===(n=a.data)||void 0===n?void 0:n.data.url,data_url:a.config.data.data_url}):t}));n.attachments=a}return n})),ae((function(e){return[].concat(Object(c.a)(e),[o])})),Jt(n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})),Kt();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),hn=function(e,t){var n=Ne,a=n.findIndex((function(t){return t.name===e.name&&t.url===e.url}));n[a]&&(n[a]=Object(r.a)(Object(r.a)({},n[a]),{},{caption:t}),Qe(n))},vn=function(e){var t,n,a,i;if(_e(e),Dt(e.sender_id,e.recipient_id,null===e||void 0===e?void 0:e.source),null===(t=window.EBQ_WEBCHAT_SOCKET)||void 0===t||!t.connected){var o=j.a.connect();o.emit("send",{type:"connection",recipient_id:e.recipient_id,sender_id:e.sender_id}),he(o)}(null!==(n=window.EBQ_WEBCHAT_SOCKET)&&void 0!==n&&n.connected&&window.EBQ_WEBCHAT_SOCKET.emit("send",{type:"connection",recipient_id:e.recipient_id,sender_id:e.sender_id}),window.EBQ_WEBCHAT_USER_INFO=e,oe((function(t){return[].concat(Object(c.a)(t),[Object(r.a)(Object(r.a)({},e),{},{sender:"bot"})])})),Object(M.a)())&&(e.rememberMe&&(null===(a=localStorage)||void 0===a||a.setItem("".concat(de.agent_code,"_webchat_user_info"),JSON.stringify(e))),!de.show_reg_form&&(null===(i=localStorage)||void 0===i||i.setItem("".concat(de.agent_code,"_webchat_user_info"),JSON.stringify(Object(r.a)(Object(r.a)({},e),{},{rememberMe:!0})))))},mn=function(){var e=re.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{buttons:[]})}));oe((function(t){return e}))},On=function(e){if(e){var t=re.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{buttons:[]})}));return oe((function(e){return t})),void Et({visible:!jt.visible,modalData:e})}Et({visible:!jt.visible,modalData:{}})},gn=function(e){on(e)},wn=function(e,t,n,a){if("web_url"===n)return On({url:a,title:e});on(e)},jn=function(e,n){var a=Array.from(e.target.files);Ae(n);var i=a.filter((function(e){return!$t(e,n)}));a.filter((function(e){return e.size>5242880})).length&&alert("You selected a file/files larger than 5MB, and any file larger than 5MB will be automatically filtered out of the selected files.");var c=a.filter((function(e){return $t(e,n)&&!(e.size>5242880)}));i.length&&alert("You selected file(s) with incorrect format, and any file(s) with incorrect format will be automatically filtered out of the selected files."),c.length&&Xt(c),"v1"===t&&c.length&&fn()};return Object(B.jsx)(B.Fragment,{children:"v1"===t?Object(B.jsx)(k,{showSignUpForm:L,chatSessions:q,sentMessages:X,pendingMessages:ne,deliveredMessages:re,versionType:t,clientInfo:de,setSocket:he,socket:be,handleUserLogOut:Pt,setIsMessageLoading:ge,isMessageLoading:Oe,isLoadingPreviousSessions:yt,userInfo:Ee,fetchUserPreviewSessions:Ft,openUploadingMediaFilesPreviewModal:Rt,isSocketConnected:Ce,toggleSignUpForm:Gt,handledFileUpload:jn,handleAddMediaToPreviewModal:Lt,selectedFileType:ke,setMediaPreviewInfo:Qe,mediaPreviewInfo:Ne,setActiveMedia:an,activeMedia:nn,showMediaUploadModal:He,setShowMediaUploadModal:De,setShowUploadButtons:Ge,showUploadButtons:Re,fileTypes:cn,supportActive:dt,toggleUploadButtonsContainer:rn,handleSendMessageToBot:on,messageTextInputValue:ze,handleTextInputValueChange:sn,addEmoji:un,showEmojiPicker:rt,toggleEmojiPicker:dn,closeEmojiPicker:ln,openMediaPreviewModal:fn,handleRemoveMediaFromPreviewModal:pn,sendMediaFiles:bn,onCaptionInputChange:hn,showIsTypingIndicator:Ye,handleAfterNewUserRegistration:vn,handleLinkButtonForMobile:mn,toggleLinkModal:On,linkModal:jt,handleQuickReplyAction:gn,handleCarouselButton:wn,showUploadingMediaFilesPreviewModal:It,showMenu:et,setShowMenu:tt,handldeFileUpload:function(e,t){var n=Array.from(e.target.files);Ae(t);var a=n.filter((function(e){return!$t(e,t)}));n.filter((function(e){return e.size>5242880})).length&&alert("You selected a file/files larger than 5MB, and any file larger than 5MB will be automatically filtered out of the selected files.");var i=n.filter((function(e){return $t(e,t)&&!(e.size>5242880)}));a.length&&alert("You selected file(s) with incorrect format, and any file(s) with incorrect format will be automatically filtered out of the selected files."),i.length&&Xt(i),i.length&&fn()},closeMediaPreviewModal:Kt,uploadingMediaFilesPreview:Tt,closeUploadingMediaFilesPreviewModal:Yt}):Object(B.jsx)(T,{setShowSignUpForm:K,showSignUpForm:L,chatSessions:q,sentMessages:X,pendingMessages:ne,deliveredMessages:re,versionType:t,clientInfo:de,setSocket:he,socket:be,handleUserLogOut:Pt,setIsMessageLoading:ge,isMessageLoading:Oe,isLoadingPreviousSessions:yt,userInfo:Ee,fetchUserPreviewSessions:Ft,openUploadingMediaFilesPreviewModal:Rt,isSocketConnected:Ce,setIsSocketConnected:Me,toggleSignUpForm:Gt,setScreenHistory:F,screenHistory:P,handledFileUpload:jn,handleAddMediaToPreviewModal:Lt,mediaPreviewInfo:Ne,setActiveMedia:an,showMediaUploadModal:He,setShowUploadButtons:Ge,showUploadButtons:Re,fileTypes:cn,supportActive:dt,isLoading:x,activeChannelList:mt,uploadingMediaFilesPreview:Tt,closeUploadingMediaFilesPreviewModal:Yt,showUploadingMediaFilesPreviewModal:It,toggleUploadButtonsContainer:rn,handleSendMessageToBot:on,messageTextInputValue:ze,handleTextInputValueChange:sn,addEmoji:un,showEmojiPicker:rt,toggleEmojiPicker:dn,closeEmojiPicker:ln,openMediaPreviewModal:fn,handleRemoveMediaFromPreviewModal:pn,sendMediaFiles:bn,onCaptionInputChange:hn,showIsTypingIndicator:Ye,handleAfterNewUserRegistration:vn,handleLinkButtonForMobile:mn,toggleLinkModal:On,linkModal:jt,handleQuickReplyAction:gn,handleCarouselButton:wn,notFound:pt})})}},82:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}));var a=n(317),i=n.n(a),c=n(335),r=n(13),o=n(12),s=function(){function e(t){Object(r.a)(this,e),this.client=void 0,this.client=t}return Object(o.a)(e,[{key:"getWebChatInitialUserMessageHistory",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:40;return this.client.get("/message/chat/".concat(e,"/").concat(t,"/?page=").concat(a,"&page_size=").concat(i,"&source=").concat(n))}},{key:"getWebChatChatSessions",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40;return this.client.get("/message/history/".concat(e,"/").concat(t,"/?page=").concat(n,"&page_size=").concat(a))}},{key:"getWebChatChatSessionMessages",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:40;return this.client.get("/message/history/session/".concat(e,"/").concat(t,"/?page=").concat(n,"&page_size=").concat(a))}},{key:"getClientCode",value:function(e){return this.client.get("/config/".concat(e))}},{key:"initialUserRegistration",value:function(e){return this.client.post("/connect",e)}},{key:"sendMessage",value:function(e){return this.client.post("/message",e)}},{key:"uploadFile",value:function(e,t){var n={onUploadProgress:function(n){var a=Math.round(100*n.loaded/n.total);t(e.filename,a)}};return this.client.post("/attachment/upload",e,n)}},{key:"sendChatToEmail",value:function(e){return this.client.post("/chathistory/email",e)}}]),e}(),u=s,d=function(){function e(t){Object(r.a)(this,e),this.client=void 0,this.client=t}return Object(o.a)(e,[{key:"getUserLocation",value:function(){return this.client.get("/bigfoot/api/location?require_city=true")}}]),e}(),l=i.a.create({baseURL:"https://webchat-be.ebanqo.io"}),f=i.a.create({baseURL:"https://ost9cv8wr3.execute-api.us-east-2.amazonaws.com/prod"}),p={webchat:new u(l),userLocation:new d(f)};Object(c.a)(l,{retries:5,retryCondition:c.a.isRetryableError,retryDelay:c.a.exponentialDelay}),Object(c.a)(f,{retries:5,retryCondition:c.a.isRetryableError,retryDelay:c.a.exponentialDelay});t.c=p},97:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return d}));var a=n(3),i=n(7),c=n(82),r=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,n){var i,r,o,s=arguments;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:1,r=s.length>3&&void 0!==s[3]?s[3]:20,e.prev=2,e.next=5,c.c.webchat.getWebChatChatSessions(t,n,i,r);case 5:return o=e.sent,e.abrupt("return","success"===o.data.status?o.data.data:[]);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}(),o=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t,n,i){var r,o,s,u=arguments;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>3&&void 0!==u[3]?u[3]:1,o=u.length>4&&void 0!==u[4]?u[4]:40,e.prev=2,e.next=5,c.c.webchat.getWebChatInitialUserMessageHistory(t,n,i,r,o);case 5:s=e.sent,e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",[]);case 11:return e.abrupt("return",s?s.data:[]);case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t,n,a){return e.apply(this,arguments)}}(),s=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.c.webchat.getClientCode(t);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return","404");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n,i,r=arguments;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"bot",r.length>2&&void 0!==r[2]?r[2]:1,r.length>3&&void 0!==r[3]?r[3]:40,e.prev=3,e.next=6,c.c.webchat.getWebChatChatSessionMessages(t,n);case 6:return i=e.sent,e.abrupt("return","success"===i.data.status&&i.data.data);case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",!1);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}(),d=function(){var e=Object(i.a)(Object(a.a)().mark((function e(t){var n;return Object(a.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.c.webchat.sendChatToEmail(t);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}}]);
//# sourceMappingURL=8.0885ab0c.chunk.js.map